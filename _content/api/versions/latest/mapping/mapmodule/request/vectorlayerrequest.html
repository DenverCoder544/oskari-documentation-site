<h1 id="vectorlayerrequest-rpc">VectorLayerRequest <span class="label label-primary rpc">RPC</span></h1>
<p>Adds a new feature layer to map or updates an existing layer.</p>
<h2 id="use-cases">Use cases</h2>
<ul>
<li>Add a new feature layer</li>
<li>Update layer properties</li>
<li>Remove vector features layer</li>
</ul>
<h2 id="description">Description</h2>
<p>Prepares a layer for later use or updates an existing layer for vector features.</p>
<p>The request takes one parameter, options.</p>
<table>
<thead>
<tr>
<th align="left">Key</th>
<th align="center">Type</th>
<th align="left">Description</th>
<th align="center">Example value</th>
</tr>
</thead>
<tbody><tr>
<td align="left">layerId</td>
<td align="center">string</td>
<td align="left">In case you want to add layer with specified id (if the layer does not exist one will be created). Needed, if at a later point you need to be able to remove features on only that specific layer or update the layer&#39;s properties.</td>
<td align="center"><code>&#39;MY_VECTOR_LAYER&#39;</code></td>
</tr>
<tr>
<td align="left">layerInspireName</td>
<td align="center">string</td>
<td align="left">Layer Inspire name (theme) when adding layer to visible (see showLayer).</td>
<td align="center"><code>&#39;Inspire theme name&#39;</code></td>
</tr>
<tr>
<td align="left">layerOrganizationName</td>
<td align="center">string</td>
<td align="left">Layer organization name when adding layer to visible (see showLayer).</td>
<td align="center"><code>&#39;Organization name&#39;</code></td>
</tr>
<tr>
<td align="left">showLayer</td>
<td align="center">boolean / string</td>
<td align="left">Adds layer to layer selector as a selected map layer or if set to <code>registerOnly</code> only adds layer to layer selector list without adding it to the map/selection.</td>
<td align="center"><code>true</code></td>
</tr>
<tr>
<td align="left">opacity</td>
<td align="center">number</td>
<td align="left">0-100</td>
<td align="center"><code>80</code></td>
</tr>
<tr>
<td align="left">layerName</td>
<td align="center">string</td>
<td align="left">Name</td>
<td align="center"><code>&#39;Layer name&#39;</code></td>
</tr>
<tr>
<td align="left">layerDescription</td>
<td align="center">string</td>
<td align="left">Description</td>
<td align="center"><code>&#39;Description text&#39;</code></td>
</tr>
<tr>
<td align="left">layerPermissions</td>
<td align="center">object</td>
<td align="left">Permissions</td>
<td align="center"><code>{ publish: &#39;publication_permission_ok&#39; }</code></td>
</tr>
<tr>
<td align="left">minResolution</td>
<td align="center">number</td>
<td align="left">Features are not shown if map resolution isn&#39;t below this.</td>
<td align="center"><code>128</code></td>
</tr>
<tr>
<td align="left">maxResolution</td>
<td align="center">number</td>
<td align="left">Features are not shown if map resolution isn&#39;t above this.</td>
<td align="center"><code>0.25</code></td>
</tr>
<tr>
<td align="left">hover</td>
<td align="center">object</td>
<td align="left">Describes how to visualize features on hover and what kind of tooltip should be shown.</td>
<td align="center">See Hover Settings below</td>
</tr>
<tr>
<td align="left">remove</td>
<td align="center">boolean</td>
<td align="left">If the key is present with &quot;truthy&quot; value the layer referenced with layerId is removed from the map. Defaults to undefined.</td>
<td align="center"><code>true</code></td>
</tr>
</tbody></table>
<p>Note! You can use minZoomLevel / maxZoomLevel or minScale / maxScale instead of minResolution / maxResolution.</p>
<h3 id="hover-settings">Hover Settings</h3>
<p>Note that features are not hovered while drawing is active (DrawTools). </p>
<p>Hover has two optional keys <code>featureStyle</code> and <code>content</code>. See <a href="/documentation/examples/oskari-style">Oskari JSON style</a> for <code>featureStyle</code> definition.</p>
<p>Content should be content of tooltip as an array. Each object creates a row to the tooltip.
Each row object has <code>key</code> or <code>keyProperty</code> and <code>valueProperty</code>.
<code>key</code> is a label and will be rendered as is.
<code>valueProperty</code> and <code>keyProperty</code> will be fetched from the feature&#39;s properties.</p>
<p>For example:</p>
<pre><code class="language-javascript">{
    &#39;featureStyle&#39;:  {
        &#39;inherit&#39;: true,
        &#39;effect&#39;: &#39;darken&#39;
    },
    &#39;content&#39;: [
        { &#39;key&#39;: &#39;Feature Data&#39; },
        { &#39;key&#39;: &#39;Feature ID&#39;, &#39;valueProperty&#39;: &#39;id&#39; },
        { &#39;keyProperty&#39;: &#39;type&#39;, &#39;valueProperty&#39;: &#39;name&#39; }
    ]
}
</code></pre>
<p>The features would be darker on mouse hover and they would have a tooltip like:</p>
<pre><code>Feature Data
Feature ID: 23098523243
Road: Main Street
</code></pre>
<h2 id="examples">Examples</h2>
<h3 id="adding-a-new-layer-example">Adding a new layer example</h3>
<p>Only prepares a layer for later use. To add features to this layer see <a href="/api/requests/#unreleased/mapping/mapmodule/request/addfeaturestomaprequest.md">AddFeaturesToMapRequest</a>.</p>
<pre><code class="language-javascript">var options = {
    layerId: &#39;MY_VECTOR_LAYER&#39;,
    layerInspireName: &#39;Inspire theme name&#39;,
    layerOrganizationName: &#39;Organization name&#39;,
    showLayer: true,
    opacity: 80,
    layerName: &#39;Layer name&#39;,
    layerDescription: &#39;Description text&#39;,
    layerPermissions: {
        &#39;publish&#39;: &#39;publication_permission_ok&#39;
    },
    maxScale: 1,
    minScale: 1451336,
    hover: {
        &#39;featureStyle&#39;:  {
            &#39;inherit&#39;: true,
            &#39;effect&#39;: &#39;darken&#39;
        }
    }
};
Oskari.getSandbox().postRequestByName(&#39;VectorLayerRequest&#39;, [options]); 
</code></pre>
<h3 id="update-layer-properties-example">Update layer properties example</h3>
<p>Define layerId which matches layer&#39;s id which should be updated. Add properties which should be updated. Note that if id doesn&#39;t match any existing layer, a new layer will be created.</p>
<pre><code class="language-javascript">var newOptions = {
    layerId: &#39;MY_VECTOR_LAYER&#39;, // existing id
    opacity: 100,
    hover: {
        &#39;featureStyle&#39;:  {
            &#39;inherit&#39;: true,
            &#39;effect&#39;: &#39;darken&#39;
        },
        &#39;content&#39;: [
            { &#39;key&#39;: &#39;Feature ID&#39;, &#39;valueProperty&#39;: &#39;test_property&#39; }
        ]
    }
};
Oskari.getSandbox().postRequestByName(&#39;VectorLayerRequest&#39;, [newOptions]); 
</code></pre>
<h3 id="remove-existing-vector-layer-as-part-of-cleanup">Remove existing vector layer as part of cleanup</h3>
<p>Define layerId which matches layer&#39;s id which should be removed. Add a remove-flag with boolean true value to remove the layer.</p>
<pre><code class="language-javascript">Oskari.getSandbox().postRequestByName(&#39;VectorLayerRequest&#39;, [{
    layerId: &#39;MY_VECTOR_LAYER&#39;, // existing id
    remove: true
}]);
</code></pre>
<h2 id="related-api">Related api</h2>
<ul>
<li>AddFeaturesToMapRequest</li>
<li>RemoveFeaturesFromMapRequest</li>
</ul>
<p><em>Included in bundle: <a href="bundles#latest/mapping/mapmodule">mapping/mapmodule</a></em></p>
