<h1 id="markers-plugin">Markers Plugin</h1>
<h2 id="description">Description</h2>
<p>The plugin offers Marker functionality for the map. Adding, removing markers and event when a marker has been added or clicked.
Also adds a button to toolbar for adding markers.</p>
<h2 id="todo">TODO</h2>
<ul>
<li>marker placeholders are much bigger than actual markers. Clicks are registered on placeholder so the click area is too large.</li>
</ul>
<h2 id="screenshot">Screenshot</h2>
<p><img src="/apires/2.13.1/mapping/mapmodule/images/mapmodule-markerplugin.png" alt="screenshot"></p>
<h2 id="plugin-configuration">Plugin configuration</h2>
<p>No configuration is required. Following is optional:</p>
<pre><code class="language-javascript">{
    markerButton : false
}
</code></pre>
<p>A toolbar button is added to toolbar by default (if toolbar bundle is present). Config can be used to prevent this.</p>
<h2 id="plugin-state">Plugin state</h2>
<p>Markers on map are saved in state:</p>
<pre><code class="language-javascript">{
    &quot;markers&quot; : [
        {
            &quot;color&quot;:&quot;ffde00&quot;,
            &quot;shape&quot;:2,
            &quot;msg&quot;:&quot;user input&quot;,
            &quot;y&quot;:7212755,
            &quot;x&quot;:427491,
            &quot;size&quot;:1
        }
    ]
}
</code></pre>
<h2 id="requests-the-plugin-handles">Requests the plugin handles</h2>
<table class="table">
  <tr>
    <th>Request</th><th>How does the bundle react</th>
  </tr>
  <tr>
    <td>[MapModulePlugin.AddMarkerRequest](/documentation/requests/addmarkerrequest)</td><td>Adds or modifies marker on the map</td>
  </tr>
  <tr>
    <td>[MapModulePlugin.RemoveMarkersRequest](/documentation/requests/removemarkersrequest)</td><td>Removes one or all markers from map</td>
  </tr>
</table>

<h2 id="requests-the-plugin-sends-out">Requests the plugin sends out</h2>
<table class="table">
  <tr>
    <th>Request</th><th>Why/when</th>
  </tr>
  <tr>
    <td> Toolbar.AddToolButtonRequest </td><td> Adds a toolbar button for activating marker tool. </td>
  </tr>
  <tr>
    <td> MapModulePlugin.GetFeatureInfoActivationRequest </td><td> Disable GFI while adding a marker. </td>
  </tr>
  <tr>
    <td> WfsLayerPlugin.ActivateHighlightRequest </td><td> Disable feature highlighting while adding a marker. </td>
  </tr>
  <tr>
    <td> Toolbar.SelectToolButtonRequest </td><td> Reset toolbar to default tool after marker has been added. </td>
  </tr>
</table>

<h2 id="events-the-plugin-listens-to">Events the plugin listens to</h2>
<table class="table">
  <tr>
    <th> Event </th><th> How does the bundle react</th>
  </tr>
  <tr>
    <td> MapClickedEvent </td><td> When marker tool is activated, adds the marker to the spot indicated by the event.</td>
  </tr>
  <tr>
    <td> Toolbar.ToolbarLoadedEvent </td><td> Registers the toolbar button if toolbar wasn't available on startup.</td>
  </tr>
  <tr>
    <td> SearchClearedEvent </td><td> Removes all markers.</td>
  </tr>
  <tr>
    <td> AfterRearrangeSelectedMapLayerEvent </td><td> Raises the markers layer to top so markers aren't lost behind another map layer.</td>
  </tr>
</table>

<h2 id="events-the-plugin-sends-out">Events the plugin sends out</h2>
<table class="table">
  <tr>
    <th>Event</th><th>Why/when</th>
  </tr>
  <tr>
    <td>AfterAddMarkerEvent</td><td> Notifies that a marker has been added and provides an ID for the marker. </td>
  </tr>
  <tr>
    <td>AfterRemoveMarkersEvent</td><td> Notifies that a marker has been removed. If event has a marker ID a single marker was removed, 
    otherwise all markers were cleared </td>
  </tr>
  <tr>
    <td>MarkerClickEvent</td><td> Notifies that a marker has been clicked. Provides the ID of the clicked marker. </td>
  </tr>
</table>

<h2 id="dependencies">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [jQuery](http://api.jquery.com/) </td>
    <td> Version 1.7.1 assumed to be linked </td>
    <td> Used to create the UI</td>
  </tr>
  <tr>
    <td> [Raphael](http://raphaeljs.com/) </td>
    <td> Version 2.1.2 assumed to be linked </td>
    <td> Used to create SVG icons </td>
  </tr>
  <tr>
    <td> [OpenLayers](http://openlayers.org/) </td>
    <td> not linked, assumes its linked by map </td>
    <td> Uses OpenLayers.Layer.Vector for marker layer and OpenLayers.Feature.Vector for markers.</td>
  </tr>
</table>
